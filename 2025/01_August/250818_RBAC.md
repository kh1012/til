# Role Based Access Control

- RBAC는 사용자의 권한(Permission)을 직접 관리하지 않고 역할(Role)을 매개로 관리하는 기법.
- User는 특정 Role을 가진다.
- Role은 특정 Permission을 가진다.
- User -> Role -> Permission의 관계를 가지며, 식별한다.

기본적인 컨셉 타이핑

```ts
// Permission 타입 정의
type Action  = "create" | "update" | "view" | "delete";
type Resource = "post" | "comment";
type Permission = `${Action}:${Resource}`;

// Roles 타입 및 실체 정의
type Role = "admin" | "member";

const ROLES: Record<Role, Set<Permission>> = {
    admin: new Set<Permission>([
        "create:post",
        "update:post",
        "view:post",
        "delete:post",
        "create:comment",
        "update:comment",
        "view:comment",
        "delete:comment",
    ]),
    member: new Set<Permission>([
        "create:post",
        "update:post",
        "view:post",
        "create:comment",
        "update:comment",
        "view:comment",
    ])
} as const;

// User 타입 정의
type User = {
    id: string;
    roles: Role[];
}

// 권한 확인 함수
function hasPermission(user: User, permission: Permission) {
    return user.roles.some(role => (ROLES[role] as readonly Set<Permission>).has(permission));
}

// 실제 사용 시,
const user: User = {
    id: 'kim',
    roles: [
        'member'
    ]
}

hasPermission(user, 'delete:comment'); // false
hasPermission(user, 'update:post'); // true
```